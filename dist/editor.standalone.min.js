/*! editor 03-11-2015 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.manshar=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=a("./selection"),e=a("./paragraph"),f=a("./utils"),g=function(a){var b=f.extend({sections:[]},a);this.editor=b.editor,this.selection=d.getInstance(),this.dom=document.createElement(g.TAG_NAME),this.sections=[];for(var c=0;c<b.sections.length;c++)this.insertSection(b.sections[c]);this.history=[],this.historyAt=0};b.exports=g,g.TAG_NAME="article",g.prototype.insertSection=function(a){return a.components&&a.components.length||a.insertComponentAt(new e,0),this.sections.push(a),this.dom.appendChild(a.dom),a},g.prototype.removeSection=function(a){var b=this.sections.indexOf(a);return this.sections.splice(b,1),a},g.prototype.updateSection=function(a){return a},g.prototype.insertComponent=function(a){var b=this.selection.getSectionAtEnd().insertComponent(a);return b},g.prototype.removeComponent=function(a){var b=this.sections.indexOf(a);return this.components.splice(b,1),a},g.prototype.getFirstComponent=function(){return this.sections[0].getFirstComponent()},g.prototype.getLastComponent=function(){return this.sections[this.sections.length-1].getLastComponent()},g.prototype.getJSONModel=function(){for(var a={sections:[]},b=0;b<this.sections.length;b++)a.sections.push(this.sections[b].getJSONModel());return a},g.prototype.transaction=function(a){this.historyAt<this.history.length&&this.history.splice(this.historyAt,this.history.length-this.historyAt),this.history.push(a),this["do"]()},g.prototype["do"]=function(){for(var a=this.history[this.historyAt++],b=0;b<a.length;b++)this.exec(a[b],"do")},g.prototype.redo=function(){this.historyAt<this.history.length&&this["do"]()},g.prototype.undo=function(){if(this.historyAt>0)for(var a=this.history[--this.historyAt],b=a.length-1;b>=0;b--)this.exec(a[b],"undo")},g.prototype.exec=function(a,b){var c,d,e,g,h,i=this.selection,j=a[b].op;if("insertChars"===j)d=a[b].component,e=a[b].value,g=a[b].index,c=f.getReference(d),c.insertCharactersAt(e,g),a[b].cursorOffset&&i.setCursor({component:c,offset:a[b].cursorOffset});else if("removeChars"===j)d=a[b].component,g=a[b].index,h=a[b].count,c=f.getReference(d),c.removeCharactersAt(g,h),a[b].cursorOffset&&i.setCursor({component:c,offset:a[b].cursorOffset});else if("updateComponent"===j)d=a[b].component,e=a[b].value,c=f.getReference(d),void 0!==e&&c.setText(e),a[b].formats&&c.applyFormats(a[b].formats),a[b].attrs&&c.updateAttributes(a[b].attrs),void 0!==a[b].cursorOffset&&(a[b].selectRange?i.select({component:c,offset:a[b].cursorOffset},{component:c,offset:a[b].cursorOffset+a[b].selectRange}):i.setCursor({component:c,offset:a[b].cursorOffset}));else if("deleteComponent"===j)c=f.getReference(a[b].component),c.section.removeComponent(c);else if("insertComponent"===j){var k=f.getReference(a[b].section),l=f.extend({name:a[b].component},a[b].attrs||{}),m=a[b].componentClass,n=this.editor.getComponentClassByName(m);c=new n(l),k.insertComponentAt(c,a[b].index)}}},{"./paragraph":16,"./selection":18,"./utils":22}],2:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./errors"),f=function(a){var b=d.extend({editor:null,section:null,name:d.getUID(),inline:!1,parentComponent:null},a);this.editor=b.editor,this.inline=b.inline,this.parentComponent=b.parentComponent,this.name=b.name,d.setReference(this.name,this),this.section=b.section};b.exports=f,f.CLASS_NAME="Component",f.onInstall=function(a){},f.registerRegexes=function(a){throw e.NotImplementedError(this.constructor.name+".registerRegexes is not implmeneted.")},f.prototype.getNextComponent=function(){if(this.parentComponent&&this.inline)return this.parentComponent.getNextComponent();if(this.section){var a=this.section.components.indexOf(this),b=this.section.components[a+1];return b?b:this.section.getNextComponent()}},f.prototype.getPreviousComponent=function(){if(this.section){var a=this.section.components.indexOf(this),b=this.section.components[a-1];return b?b:this.section.getPreviousComponent()}},f.prototype.getJSONModel=function(){var a={name:this.name,text:this.text,ComponentType:this.ComponentType};return this.formats&&(a.formats=this.formats),a},f.prototype.getIndexInSection=function(){return this.section?this.section.components.indexOf(this):this.parentComponent?this.parentComponent.components?this.parentComponent.components.indexOf(this):0:null},f.prototype.getDeleteOps=function(a){throw e.NotImplementedError("Component Must Implement getDeleteOps")},f.prototype.getInsertOps=function(a){throw e.NotImplementedError("Component Must Implement getDeleteOps")},f.prototype.getInsertCharsOps=function(a,b){throw e.NotImplementedError("Component Must Implement getInsertCharsOps")},f.prototype.getRemoveCharsOps=function(a,b,c){throw e.NotImplementedError("Component Must Implement getRemoveCharsOps")},f.prototype.getUpdateOps=function(a,b,c){throw e.NotImplementedError("Component does not Implement getUpdateOps")},f.prototype.getLength=function(){return 0}},{"./errors":4,"./utils":22}],3:[function(a,b,c){"use strict";var d=a("./article"),e=a("./paragraph"),f=a("./list"),g=a("./figure"),h=a("./section"),i=a("./utils"),j=a("./errors"),k=a("./extensions/formatting"),l=a("./extensions/shortcutsManager"),m=a("./extensions/componentFactory"),n=a("./toolbars/toolbar"),o=a("./extensions/toolbelt"),p=a("./extensions/uploadExtension"),q=function(a,b){var c=i.extend({modules:[],rtl:!1,article:new d({editor:this,sections:[new h({components:[new e({placeholder:"Editor",paragraphType:e.Types.MainHeader})]})]}),extensions:[new k,new o,new p]},b);this.componentFactory=new m,this.installedModules={},this.install(e),this.install(f),this.install(g);for(var j=0;j<c.modules.length;j++)this.install(c.modules[j]);this.name=i.getUID(),this.rtl=c.rtl,this.extensions=c.extensions,this.element=a,this.article=c.article,this.article.editor=this,this.shortcutsManager=new l(this),this.toolbars={};var r=new n({name:q.INLINE_TOOLBAR_NAME,classNames:[q.INLINE_TOOLBAR_CLASS_NAME]});this.registerToolbar(q.INLINE_TOOLBAR_NAME,r);var s=new n({name:q.BLOCK_TOOLBAR_NAME,classNames:[q.BLOCK_TOOLBAR_CLASS_NAME]});this.registerToolbar(q.BLOCK_TOOLBAR_NAME,s),this.init()};q.prototype=new i.CustomEventTarget,b.exports=q,q.INLINE_TOOLBAR_CLASS_NAME="editor-inline-toolbar",q.BLOCK_TOOLBAR_CLASS_NAME="editor-block-toolbar",q.BLOCK_TOOLBAR_NAME="block-toolbar",q.INLINE_TOOLBAR_NAME="inline-toolbar",q.ATTACHMENT_ADDED_EVENT_NAME="attachment-added",q.prototype.init=function(){if(this.article.selection.initSelectionListener(this.element),this.extensions)for(var a=0;a<this.extensions.length;a++){var b=this.extensions[a];"function"==typeof b.init&&b.init(this)}this.element.addEventListener("keydown",this.handleKeyDownEvent.bind(this)),this.element.addEventListener("cut",this.handleCut.bind(this)),this.element.addEventListener("paste",this.handlePaste.bind(this)),this.element.className+=" manshar-editor",this.element.setAttribute("contenteditable",!0),this.element.appendChild(this.article.dom),this.article.selection.setCursor({component:this.article.sections[0].components[0],offset:0})},q.prototype.install=function(a){if(this.installedModules[a.CLASS_NAME])throw j.AlreadyRegisteredError(a.CLASS_NAME+" module has already been installed in this editor.");this.installedModules[a.CLASS_NAME]=a,a.onInstall(this)},q.prototype.registerToolbar=function(a,b){this.toolbars[a]=b},q.prototype.getToolbar=function(a){return this.toolbars[a]},q.prototype.getComponentClassByName=function(a){return this.installedModules[a]},q.prototype.registerRegex=function(a,b,c){this.componentFactory.registerRegex(a,b,c)},q.prototype.handleKeyDownEvent=function(a){var b,c,d,f=this.article.selection,g=this.article,h=!1,j=[],k=[];if(i.isUndo(a))this.article.undo(),h=!0;else if(i.isRedo(a))this.article.redo(),h=!0;else if(i.isSelectAll(a))f.select({component:g.getFirstComponent(),cursor:0},{component:g.getLastComponent(),cursor:g.getLastComponent().getLength()}),h=!0;else if(f.isRange()&&i.willTypeCharacter(a)){var l=f.getSectionAtStart();k=l.getComponentsBetween(f.getComponentAtStart(),f.getComponentAtEnd()),i.arrays.extend(j,this.getDeleteSelectionOps()),this.article.transaction(j),j=[];var m=[13,8,46];h=-1!==m.indexOf(a.keyCode)}var n,o=f.getComponentAtEnd(),p=o.getIndexInSection(),q=o.getNextComponent(),r=o.getPreviousComponent();switch(a.keyCode){case 13:if(!f.isCursorAtEnding()&&o instanceof e&&!o.inline)i.arrays.extend(j,this.getSplitParagraphOps(-k.length));else if(q instanceof e&&(q.isPlaceholder()||o.inline))f.setCursor({component:q,offset:0});else{var s;if(o instanceof e&&(s=this.componentFactory.match(o.text)),s)s(o,function(a){g.transaction(a)});else{var t=o.paragraphType,u=f.getSectionAtEnd(),v=p-k.length+1;if(t===e.Types.ListItem){if(0===o.getLength()){var w=u;t=e.Types.Paragraph,u=f.getSectionAtEnd().section,v<w.getLength()&&i.arrays.extend(j,w.getSplitOps(v)),i.arrays.extend(j,o.getDeleteOps(v)),v=f.getSectionAtEnd().getIndexInSection()+1}}else o.parentComponent&&o.inline?(u=o.parentComponent.section,v=o.parentComponent.getIndexInSection()+1,t=e.Types.Paragraph):t=e.Types.Paragraph;b=new e({section:u,paragraphType:t}),i.arrays.extend(j,b.getInsertOps(v))}}this.article.transaction(j),h=!0;break;case 8:o instanceof e?f.isCursorAtBeginning()&&r?(n=0,r instanceof e&&(n=r.text.length,i.arrays.extend(j,this.getMergeParagraphsOps(r,o,-k.length)),this.article.transaction(j)),f.setCursor({component:r,offset:n}),h=!0):f.isCursorAtBeginning()&&!r&&(h=!0):(i.arrays.extend(j,o.getDeleteOps(-k.length)),r?(this.article.transaction(j),f.setCursor({component:r,offset:r.getLength()})):q?(this.article.transaction(j),f.setCursor({component:q,offset:0})):(b=new e({section:f.getSectionAtEnd()}),i.arrays.extend(j,b.getInsertOps(p-k.length)),this.article.transaction(j)),h=!0);break;case 46:o instanceof e?f.isCursorAtEnding()&&q&&(q instanceof e?(n=o.text.length,i.arrays.extend(j,this.getMergeParagraphsOps(o,q,-k.length)),this.article.transaction(j),f.setCursor({component:o,offset:n})):f.setCursor({component:q,offset:0}),h=!0):(i.arrays.extend(j,o.getDeleteOps(-k.length)),r?(this.article.transaction(j),f.setCursor({component:r,offset:r.getLength()})):q?(this.article.transaction(j),f.setCursor({component:q,offset:0})):(b=new e({section:f.getSectionAtEnd()}),i.arrays.extend(j,b.getInsertOps(p-k.length)),this.article.transaction(j)),h=!0);break;case 37:f.isCursorAtBeginning()&&r&&(c=0,r instanceof e&&(c=r.getLength()),f.setCursor({component:r,offset:c}),h=!0);break;case 38:r&&(c=0,r instanceof e&&(d=f.start.offset,c=Math.min(r.getLength(),d)),f.setCursor({component:r,offset:c}),h=!0);break;case 39:f.isCursorAtEnding()&&q&&(f.setCursor({component:q,offset:0}),h=!0);break;case 40:q&&(c=0,q instanceof e&&(d=f.end.offset,c=Math.min(q.getLength(),d)),f.setCursor({component:q,offset:c}),h=!0)}if(h)a.preventDefault(),a.stopPropagation();else if(o&&i.willTypeCharacter(a)){var x=o.text,y=-1!==[46,8].indexOf(a.keyCode),z=1;8===a.keyCode?z=-1:46===a.keyCode&&(z=0),setTimeout(function(){var a=o.dom.innerText,b=f.end.offset+z;if(y){if(x){var c=x.charAt(b);i.arrays.extend(j,o.getRemoveCharsOps(c,b,z))}}else{var d=a.charAt(Math.min(b,a.length)-1);i.arrays.extend(j,o.getInsertCharsOps(d,f.end.offset))}g.transaction(j)},3)}var A=this.dispatchEvent.bind(this);setTimeout(function(){A(new Event("change"))},10)},q.prototype.getDeleteSelectionOps=function(){for(var a,b=[],c=this.article.selection,d=c.getSectionAtStart(),f=d.getComponentsBetween(c.getComponentAtStart(),c.getComponentAtEnd()),g=0;g<f.length;g++)i.arrays.extend(b,f[g].getDeleteOps(-g));if(c.getComponentAtEnd()!==c.getComponentAtStart()){var h=c.getComponentAtEnd();if(i.arrays.extend(b,h.getDeleteOps(-f.length)),h instanceof e){var j=h.text,k=j.substring(c.end.offset,j.length),l=c.getComponentAtStart().text,m=l.substring(c.start.offset,l.length),n=c.getComponentAtStart(),o=n.getFormatsForRange(c.start.offset,l.length),p=l.length-c.start.offset;i.arrays.extend(b,n.getUpdateOps({formats:o},c.start.offset,p)),i.arrays.extend(b,n.getRemoveCharsOps(m,c.start.offset));var q=j.length-k.length;i.arrays.extend(b,n.getInsertCharsOps(k,c.start.offset));for(var r=h.getFormatsForRange(c.end.offset,j.length),s=-q+c.start.offset,t=0;t<r.length;t++)r[t].from+=s,r[t].to+=s;i.arrays.extend(b,n.getUpdateOps({formats:r},l.length-m.length))}}else{var u=c.getComponentAtStart(),v=u.text.substring(c.start.offset,c.end.offset);a=c.end.offset-c.start.offset;var w=u.getFormatsForRange(c.start.offset,c.end.offset);i.arrays.extend(b,u.getUpdateOps({formats:w},c.start.offset,a)),i.arrays.extend(b,u.getRemoveCharsOps(v,c.start.offset))}return b},q.prototype.getSplitParagraphOps=function(a){var b=[],c=this.article.selection,d=c.getComponentAtEnd(),f=d.getIndexInSection(),g=d.text.substring(c.end.offset,d.text.length),h=d.getFormatsForRange(c.start.offset,d.text.length);i.arrays.extend(b,d.getUpdateOps({formats:h},c.start.offset)),i.arrays.extend(b,d.getRemoveCharsOps(g,c.start.offset));for(var j=i.clone(h),k=-c.start.offset,l=0;l<j.length;l++)j[l].from+=k,j[l].to+=k;var m=new e({section:c.getSectionAtEnd(),text:g,formats:j,paragraphType:d.paragraphType});return i.arrays.extend(b,m.getInsertOps(f+a+1)),b},q.prototype.getMergeParagraphsOps=function(a,b,c){var d=[],e=a.text.length;i.arrays.extend(d,b.getDeleteOps(-c)),i.arrays.extend(d,a.getInsertCharsOps(b.text,e));for(var f=i.clone(b.formats),g=a.text.length,h=0;h<f.length;h++)f[h].from+=g,f[h].to+=g;return i.arrays.extend(d,a.getUpdateOps({formats:f},e)),d},q.prototype.handlePaste=function(a){var b;window.clipboardData&&window.clipboardData.getData?b=window.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(b=a.clipboardData.getData("text/html")||a.clipboardData.getData("text/plain"));var c=document.createElement("div");c.innerHTML=b;var d=this.processPastedContent(c);this.article.transaction(d),a.preventDefault()},q.prototype.getJSONModel=function(){return this.article.getJSONModel()},q.prototype.processPastedContent=function(a,b){function c(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(-1===x.indexOf(b[c].nodeName))return!1;return!0}function d(a){var b;return b=a.nodeType===Node.TEXT_NODE?"data":w?"textContent":"innerText"}function f(a){for(var b=0,c=0;c<a.length;c++)a[c]&&"meta"===a[c].nodeName.toLowerCase()&&b++;return a.length-b<2?!0:void 0}var h,j,l,m,n,o=[],p=a.innerText,q=a.childNodes,r=this.article.selection,s=r.getComponentAtStart(),t=r.getSectionAtStart(),u=s.getIndexInSection(),v=b||u,w=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,x="B BR BIG I SMALL ABBR ACRONYM CITE EM STRONG A BDO"+" STRIKE S SPAN SUB SUP #text META".split(" ");if(q&&q.length&&!f(q))if(c(a))h=a[d(a)],m=new e({section:t,text:h,paragraphType:j,formats:k.generateFormatsForNode(a)}),i.arrays.extend(o,m.getInsertOps(v++));else{r.isCursorAtEnding()||i.arrays.extend(o,this.getSplitParagraphOps(v)),v++;for(var y=0;y<q.length;y++){var z=q[y],A=z.nodeName&&z.nodeName.toLowerCase();switch(A){case void 0:case"meta":case"script":case"style":case"embed":case"br":case"hr":continue;case"figure":var B=z.getElementsByTagName("img");if(!B||!B.length)continue;for(var C=0;C<B.length;C++)n=new g({src:B[C].getAttribute("src")}),n.section=r.getSectionAtEnd(),i.arrays.extend(o,n.getInsertOps(v++));j=null;break;case"img":n=new g({src:z.getAttribute("src")}),n.section=r.getSectionAtEnd(),i.arrays.extend(o,n.getInsertOps(v++)),j=null;break;case"ul":case"ol":case"p":case"#text":j=e.Types.Paragraph;break;case"blockquote":j=e.Types.Quote;break;case"h1":j=e.Types.MainHeader;break;case"h2":j=e.Types.SecondaryHeader;break;case"h3":case"h4":case"h5":case"h6":j=e.Types.ThirdHeader;break;case"pre":j=e.Types.Code;break;default:c(q[y])?j=e.Types.Paragraph:(l=this.processPastedContent(q[y],v),v+=l.length/2)}l?i.arrays.extend(o,l):j&&(h=z[d(z)],m=new e({section:t,text:h,paragraphType:j,formats:k.generateFormatsForNode(z)}),i.arrays.extend(o,m.getInsertOps(v++)))}}else{var D=s.text.substring(0,r.start.offset),E=D.length;i.arrays.extend(o,s.getInsertCharsOps(p,E))}return o},q.prototype.handleCut=function(){var a=this.getDeleteSelectionOps(),b=this.article,c=this.dispatchEvent.bind(this);setTimeout(function(){b.transaction(a),c(new Event("change"))},20)}},{"./article":1,"./errors":4,"./extensions/componentFactory":6,"./extensions/formatting":7,"./extensions/shortcutsManager":9,"./extensions/toolbelt":10,"./extensions/uploadExtension":11,"./figure":13,"./list":14,"./paragraph":16,"./section":17,"./toolbars/toolbar":21,"./utils":22}],4:[function(a,b,c){"use strict";var d={};b.exports=d,d.NotImplementedError=function(a){this.name="NotImplementedError",this.message=a||""},d.NotImplementedError.prototype=Error.prototype,d.AlreadyRegisteredError=function(a){this.name="AlreadyRegisteredError",this.message=a||""},d.AlreadyRegisteredError.prototype=Error.prototype},{}],5:[function(a,b,c){"use strict";var d=a("../utils"),e=function(a){var b=d.extend({file:null,figure:null,insertedOps:null},a);this.file=b.file,this.figure=b.figure,this.insertedOps=b.insertedOps};b.exports=e,e.prototype.setUploadProgress=function(a){this.progress=a},e.prototype.setAttributes=function(a){for(var b=0;b<this.insertedOps.length;b++){var c=d.extend(this.insertedOps[b]["do"].attrs||{},a);this.insertedOps[b]["do"].attrs=c}this.figure.updateAttributes(a)}},{"../utils":22}],6:[function(a,b,c){"use strict";var d=a("../errors"),e=function(){this.regexToFactories={}};b.exports=e,e.prototype.registerRegex=function(a,b,c){if(this.regexToFactories[a]&&!c)throw d.AlreadyRegisteredError('This Regex "'+a+'" has already been registered.');this.regexToFactories[a]=b},e.prototype.match=function(a){for(var b in this.regexToFactories){var c=new RegExp(b),d=c.exec(a);if(d)return this.regexToFactories[b]}}},{"../errors":4}],7:[function(a,b,c){"use strict";var d=a("../paragraph"),e=a("../selection"),f=a("../utils"),g=a("../toolbars/button"),h=a("../toolbars/textField"),i=function(a){var b=f.extend({enableInline:!0,enableBlock:!0},a);this.enableInline=b.enableInline,this.enableBlock=b.enableBlock,this.editor=null};b.exports=i,i.ACTIVE_ACTION_CLASS="active",i.Types={BLOCK:"block",INLINE:"inline"},i.BLOCK_ENABLED_ON=[d.Types.Paragraph,d.Types.MainHeader,d.Types.SecondaryHeader,d.Types.ThirdHeader,d.Types.Quote,d.Types.Code],i.Actions={Block:[{label:"h1",value:d.Types.MainHeader,shortcuts:["alt+cmd+1","alt+ctrl+1"]},{label:"h2",value:d.Types.SecondaryHeader,shortcuts:["alt+cmd+2","alt+ctrl+2"]},{label:"h3",value:d.Types.ThirdHeader,shortcuts:["alt+cmd+3","alt+ctrl+3"]},{label:"”",value:d.Types.Quote,shortcuts:["alt+cmd+4","alt+ctrl+4"]},{label:"{}",value:d.Types.Code,shortcuts:["alt+cmd+5","alt+ctrl+5"]}],Inline:[{label:"B",value:"strong",tagNames:["strong","b"],shortcuts:["ctrl+b","cmd+b"]},{label:"I",value:"em",tagNames:["em","i"],shortcuts:["ctrl+i","cmd+i"]},{label:"U",value:"u",tagNames:["u"],shortcuts:["ctrl+u","cmd+u"]},{label:"S",value:"s",tagNames:["strike","s"],shortcuts:["ctrl+s","cmd+s"]},{label:"a",value:"a",attrs:{href:{required:!0,placeholder:"What is the URL?"}},tagNames:["a"],shortcuts:["ctrl+k","cmd+k"]}]},i.BLOCK_TOOLBAR_NAME="block-toolbar",i.INLINE_TOOLBAR_NAME="inline-toolbar",i.prototype.init=function(a){this.editor=a,this.blockToolbar=a.getToolbar(i.BLOCK_TOOLBAR_NAME),this.inlineToolbar=a.getToolbar(i.INLINE_TOOLBAR_NAME),this.initInlineToolbarButtons(),this.initBlockToolbarButtons(),this.registerFormattingShortcuts_(),this.editor.article.selection.addEventListener(e.Events.SELECTION_CHANGED,this.handleSelectionChangedEvent.bind(this))},i.prototype.initInlineToolbarButtons=function(){for(var a=i.Actions.Inline,b=0;b<a.length;b++){var c=this.createExtraFields(a[b]),d=new g({name:a[b].value,label:a[b].label,data:a[b],fields:c||[]});d.addEventListener("click",this.handleInlineFormatterClicked.bind(this)),this.inlineToolbar.addButton(d)}},i.prototype.initBlockToolbarButtons=function(){for(var a=i.Actions.Block,b=0;b<a.length;b++){var c=new g({name:a[b].value,label:a[b].label,data:a[b]});c.addEventListener("click",this.handleBlockFormatterClicked.bind(this)),this.blockToolbar.addButton(c)}},i.prototype.registerFormattingShortcuts_=function(){for(var a in i.Actions)for(var b=i.Actions[a],c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.shortcuts.length;e++)this.editor.shortcutsManager.register(d.shortcuts[e],this.handleKeyboardShortcut.bind(this))},i.prototype.createExtraFields=function(a){var b=[];if(!a.attrs)return b;for(var c in a.attrs){var d=a.attrs[c],e=new h({placeholder:d.placeholder,required:d.required,name:c});e.addEventListener("keyup",this.handleInlineInputFieldKeyUp.bind(this)),b.push(e)}return b},i.prototype.applyFormatWithAttrs=function(a){for(var b=a.data.value,c={},d=a.fields,e=0;e<d.length;e++)c[d[e].name]=d[e].value;this.handleInlineFormatting(b,c)},i.prototype.handleInlineInputFieldKeyUp=function(a){13===a.keyCode&&this.applyFormatWithAttrs(a.detail.target.parentButton)},i.prototype.handleSelectionChangedEvent=function(){var a=window.getSelection(),b=e.getInstance(),c=b.getComponentAtStart(),f=b.getComponentAtEnd();this.blockToolbar.setVisible(!1),this.inlineToolbar.setVisible(!1),a.isCollapsed?(c instanceof d&&-1!==i.BLOCK_ENABLED_ON.indexOf(c.paragraphType)&&(this.blockToolbar.setPositionToStartTopOf(c.dom),this.blockToolbar.setVisible(!0)),this.reloadBlockToolbarStatus()):c instanceof d&&c===f&&(this.inlineToolbar.setPositionTopOfSelection(),this.inlineToolbar.setVisible(!0),this.reloadInlineToolbarStatus())},i.prototype.reloadBlockToolbarStatus=function(){var a=this.editor.article.selection,b=a.getComponentAtStart(),c=this.blockToolbar.getButtonByName(b.paragraphType);this.blockToolbar.setActiveButton(c)},i.prototype.reloadInlineToolbarStatus=function(){var a=this.editor.article.selection,b=a.getComponentAtStart(),c=b.getSelectedFormatter(a),d=null,e={},f=null;c&&(d=this.getFormatterForValue(c.type),e=c.attrs,f=this.inlineToolbar.getButtonByName(c.type)),this.inlineToolbar.resetFields();for(var g in e){var h=f.getFieldByName(g);h.setValue(e[g])}this.inlineToolbar.setActiveButton(f)},i.prototype.handleBlockFormatterClicked=function(a){var b=a.detail.target.data;this.handleBlockFormatting(b.value),this.reloadBlockToolbarStatus(),a.preventDefault(),a.stopPropagation()},i.prototype.handleBlockFormatting=function(a){for(var b=this.editor.article.selection,c=b.getSelectedComponents(),e=[],g=0;g<c.length;g++){var h=a;c[g].paragraphType===a&&(h=d.Types.Paragraph);var i=c[g].getIndexInSection()+g;f.arrays.extend(e,c[g].getDeleteOps()),c[g].paragraphType=h,f.arrays.extend(e,c[g].getInsertOps(i))}this.editor.article.transaction(e),this.editor.dispatchEvent(new Event("change"))},i.prototype.format=function(a,b,c){var d,e,g,h=[],i=a.getUpdateOps({formats:[]},b.start.offset,b.end.offset-b.start.offset),j=i[0]["do"],k=a.getFormattedRanges(c,!0);if(k&&k.length)for(var l=0;l<k.length;l++){var m=k[l];if(c.attrs){d=f.clone(j);var n=f.clone(m);n.attrs=c.attrs,d.formats.push(n),e=f.clone(j),e.formats.push(f.clone(m))}else c.to===m.to&&c.from===m.from?(d=f.clone(j),d.formats.push(f.clone(c)),e=d):c.to===m.to?(d=f.clone(j),d.formats.push(c),e=d):c.from===m.from?(d=f.clone(j),d.formats.push(c),e=d):c.to<m.to&&c.from>m.from?(d=f.clone(j),d.formats.push(m),d.formats.push({type:m.type,from:m.from,to:c.from,attrs:c.attrs}),d.formats.push({type:m.type,from:c.to,to:m.to,attrs:c.attrs}),e=f.clone(d),e.formats.reverse()):(d=f.clone(j),d.formats.push(m),d.formats.push({type:m.type,from:Math.min(m.from,c.from),to:Math.max(m.to,c.to)}),e=f.clone(d),e.formats.reverse())}else{var o=a.getFormatsForRange(c.from,c.to);d=f.clone(j),f.arrays.extend(d.formats,o),d.formats.push(c),e=f.clone(d),delete e.formats[e.formats.length-1].attrs,e.formats.reverse()}return g={"do":d,undo:e},h.push(g),h},i.prototype.handleInlineFormatterClicked=function(a){var b=a.detail.target.data,c=b.value;if(b.attrs){var d=this.editor.article.selection,e=d.getComponentAtStart(),f=e.getSelectedFormatter(d);f&&c===f.type?(this.handleInlineFormatting(c),this.reloadInlineToolbarStatus()):this.inlineToolbar.setActiveButton(a.detail.target)}else this.handleInlineFormatting(c),this.reloadInlineToolbarStatus();a.preventDefault(),a.stopPropagation()},i.prototype.handleInlineFormatting=function(a,b){var c=this.editor.article.selection,d=c.getComponentAtStart(),e={type:a,from:c.start.offset,to:c.end.offset,attrs:b};if(c.end.offset-c.start.offset!==0){var f=this.format(d,c,e);this.editor.article.transaction(f),this.editor.dispatchEvent(new Event("change"))}},i.prototype.handleKeyboardShortcut=function(a){var b=this.editor.shortcutsManager.getShortcutId(a),c=this.getInlineFormatterForShortcut(b);if(c)return this.handleInlineFormatting(c.value),!1;var d=this.getBlockFormatterForShortcut(b);return d?(this.handleBlockFormatting(d.value),!1):!0},i.prototype.getInlineFormatterForShortcut=function(a){for(var b=i.Actions.Inline,c=0;c<b.length;c++)if(-1!==b[c].shortcuts.indexOf(a))return b[c];return null},i.prototype.getBlockFormatterForShortcut=function(a){for(var b=i.Actions.Block,c=0;c<b.length;c++)if(-1!==b[c].shortcuts.indexOf(a))return b[c];return null},i.prototype.getFormatterForValue=function(a){for(var b=i.Actions.Block,c=0;c<b.length;c++)if(b[c].value===a)return b[c];var d=i.Actions.Inline;for(c=0;c<d.length;c++)if(d[c].value===a)return d[c];return null},i.getActionForTagName=function(a){a=a&&a.toLowerCase();for(var b=i.Actions.Inline,c=0;c<b.length;c++)if(-1!==b[c].tagNames.indexOf(a))return b[c];return null},i.generateFormatsForNode=function(a){for(var b=[],c=0,d=a.childNodes,e=0;e<d.length;e++){var f=d[e],g=i.getActionForTagName(f.tagName);if(g){var h={};for(var j in g.attrs)h[j]=f.getAttribute(j);b.push({type:g.value,from:c,to:c+f.innerText.length,attrs:h})}c+=f.textContent.length}return b}},{"../paragraph":16,"../selection":18,"../toolbars/button":19,"../toolbars/textField":20,"../utils":22}],8:[function(a,b,c){"use strict";var d=a("../utils"),e=a("../selection"),f=a("../component"),g=function(a){var b=d.extend({src:"",caption:null,width:"100%",name:d.getUID()},a);this.name=b.name,d.setReference(this.name,this),this.src=b.src,this.width=b.width,this.caption=b.caption,this.dom=document.createElement(g.CONTAINER_TAG_NAME),this.dom.setAttribute("contenteditable",!1),this.dom.setAttribute("name",this.name),this.dom.addEventListener("click",this.handleClick.bind(this)),this.captionDom=document.createElement(g.CAPTION_TAG_NAME),this.captionDom.setAttribute("contenteditable",!0),this.imgDom=document.createElement(g.IMAGE_TAG_NAME),this.caption&&(this.captionDom.innerText=this.caption,this.dom.appendChild(this.captionDom)),this.src&&(this.imgDom.setAttribute("src",this.src),this.width&&this.imgDom.setAttribute("width",this.width),this.dom.appendChild(this.imgDom))};g.prototype=new f,b.exports=g,g.CLASS_NAME="GiphyComponent",g.CONTAINER_TAG_NAME="figure",g.IMAGE_TAG_NAME="img",g.CAPTION_TAG_NAME="figcaption",g.GIPHY_SEARCH_REGEXS=["/giphy\\s(.+[a-zA-Z])"],g.GIPHY_RANDOM_ENDPOINT="https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&tag=",g.onInstall=function(a){g.registerRegexes_(a)},g.registerRegexes_=function(a){for(var b=0;b<g.GIPHY_SEARCH_REGEXS.length;b++)a.registerRegex(g.GIPHY_SEARCH_REGEXS[b],g.handleMatchedRegex)},g.handleMatchedRegex=function(a,b){var c=a.text.split(/\s/).slice(1).join("+"),e=a.getIndexInSection(),f=[],h=new XMLHttpRequest;h.onreadystatechange=function(){if(4==h.readyState&&200==h.status){var c;if(c=JSON.parse(h.responseText).data.image_original_url){var i=new g({src:c});i.section=a.section,d.arrays.extend(f,a.getDeleteOps(e)),d.arrays.extend(f,i.getInsertOps(e)),b(f)}}},h.open("GET",g.GIPHY_RANDOM_ENDPOINT+c,!0),h.send()},g.prototype.getJSONModel=function(){var a={name:this.name,src:this.src,caption:this.caption};return a},g.prototype.handleClick=function(){var a=e.getInstance();a.setCursor({component:this,offset:0})},g.prototype.getDeleteOps=function(a){return[{"do":{op:"deleteComponent",component:this.name},undo:{op:"insertComponent",componentClass:"GiphyComponent",section:this.section.name,component:this.name,index:this.getIndexInSection()+(a||0),attrs:{src:this.src,caption:this.caption,width:this.width}}}]},g.prototype.getInsertOps=function(a){return[{"do":{op:"insertComponent",componentClass:"GiphyComponent",section:this.section.name,cursorOffset:0,component:this.name,index:a,attrs:{src:this.src,width:this.width,caption:this.caption}},undo:{op:"deleteComponent",component:this.name}}]},g.prototype.getLength=function(){return 1}},{"../component":2,"../selection":18,"../utils":22}],9:[function(a,b,c){"use strict";var d=function(a){this.editor=a,this.registery={},this.editor.element.addEventListener("keydown",this.handleKeyDownEvent.bind(this))};b.exports=d,d.META_KEYS=[16,17,91],d.prototype.getShortcutId=function(a){var b=[],c=a.keyCode||a.which;return-1!==d.META_KEYS.indexOf(c)?!1:(a.metaKey&&b.push("cmd"),a.ctrlKey&&b.push("ctrl"),a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),b.sort(),c&&b.push(String.fromCharCode(c)),b.join("+").toLowerCase())},d.prototype.isShortcutEvent=function(a){var b=a.keyCode||a.which;return(a.metaKey||a.ctrlKey)&&b&&-1===d.META_KEYS.indexOf(b)},d.prototype.handleKeyDownEvent=function(a){if(this.isShortcutEvent(a)){var b=this.getShortcutId(a);if(this.registery[b]){var c=this.registery[b](a);if(c===!1)return a.preventDefault(),a.stopPropagation(),!1}}return!0},d.prototype.register=function(a,b,c){if(this.registery[a]&&!c)throw'"'+a+'" shortcut has already been registered.';this.registery[a]=b}},{}],10:[function(a,b,c){"use strict";var d=a("../selection"),e=a("../toolbars/toolbar"),f=a("../toolbars/button"),g=function(){this.editor=null,this.toolbar=null,this.blockToolbar=null,this.insertButton=new f({label:"+"}),this.insertButton.setVisible(!1),this.insertButton.addEventListener("click",this.handleInsertClick.bind(this))};b.exports=g,g.prototype.init=function(a){this.editor=a,this.blockToolbar=this.editor.getToolbar(g.BLOCK_TOOLBAR_NAME),this.blockToolbar.addButton(this.insertButton),this.toolbar=new e({name:g.TOOLBELT_TOOLBAR_NAME,classNames:[g.TOOLBELT_TOOLBAR_CLASS_NAME]}),this.toolbar.addEventListener("button-added",this.handleButtonAdded.bind(this)),this.editor.registerToolbar(g.TOOLBELT_TOOLBAR_NAME,this.toolbar),this.editor.article.selection.addEventListener(d.Events.SELECTION_CHANGED,this.handleSelectionChangedEvent.bind(this))},g.TOOLBELT_TOOLBAR_NAME="toolbelt-toolbar",g.TOOLBELT_TOOLBAR_CLASS_NAME="toolbelt-toolbar",g.BLOCK_TOOLBAR_NAME="block-toolbar",g.prototype.handleInsertClick=function(){this.toolbar.setPositionToStartBottomOf(this.insertButton.dom),this.toolbar.setVisible(!this.toolbar.isVisible)},g.prototype.handleSelectionChangedEvent=function(){this.toolbar.setVisible(!1)},g.prototype.handleButtonAdded=function(){this.insertButton.setVisible(!0)}},{"../selection":18,"../toolbars/button":19,"../toolbars/toolbar":21}],11:[function(a,b,c){"use strict";var d=a("../toolbars/button"),e=a("../utils"),f=a("../figure"),g=a("./attachment"),h=function(a){var b=e.extend({label:"Upload"},a);d.call(this,b),this.dom.classList.add(h.UPLOAD_CONTAINER_CLASS_NAME),this.uploadButtonDom=document.createElement(h.TAG_NAME),this.uploadButtonDom.setAttribute("type","file"),this.uploadButtonDom.setAttribute("name",this.name),this.uploadButtonDom.addEventListener("change",this.handleChange.bind(this)),this.dom.appendChild(this.uploadButtonDom);

};h.prototype=Object.create(d.prototype),h.UPLOAD_CONTAINER_CLASS_NAME="upload-button",h.TAG_NAME="input",h.prototype.handleChange=function(a){var b={target:this,files:a.target.files},c=new CustomEvent("change",{detail:b});this.dispatchEvent(c),a.target.value=""};var i=function(){this.editor=null,this.toolbelt=null};b.exports=i,i.TOOLBELT_TOOLBAR_NAME="toolbelt-toolbar",i.ATTACHMENT_ADDED_EVENT_NAME="attachment-added",i.prototype.init=function(a){this.editor=a,this.toolbelt=this.editor.getToolbar(i.TOOLBELT_TOOLBAR_NAME);var b=new h({label:"Upload Photo"});b.addEventListener("change",this.handleUpload.bind(this)),this.toolbelt.addButton(b)},i.prototype.handleUpload=function(a){var b=this,c=a.detail.files[0];this.readFileAsDataUrl_(c,function(a){var d=b.editor.article.selection,e=d.getComponentAtStart(),h=new f({src:a});h.section=d.getSectionAtStart();var j=h.getInsertOps(e.getIndexInSection());b.editor.article.transaction(j);var k=new g({file:c,figure:d.getComponentAtStart(),editor:b.editor,insertedOps:j}),l=new CustomEvent(i.ATTACHMENT_ADDED_EVENT_NAME,{detail:{attachment:k}});b.editor.dispatchEvent(l)})},i.prototype.readFileAsDataUrl_=function(a,b){var c=new FileReader;c.onload=function(a){return function(a){b(a.target.result)}}(a),c.readAsDataURL(a)}},{"../figure":13,"../toolbars/button":19,"../utils":22,"./attachment":5}],12:[function(a,b,c){"use strict";var d=a("../utils"),e=a("../selection"),f=a("../component"),g=function(a){var b=d.extend({src:"",caption:null,width:"100%",height:"360px",name:d.getUID()},a);this.name=b.name,d.setReference(this.name,this),this.src=b.src,this.width=b.width,this.height=b.height,this.caption=b.caption,this.dom=document.createElement(g.CONTAINER_TAG_NAME),this.dom.setAttribute("contenteditable",!1),this.dom.setAttribute("name",this.name),this.overlayDom=document.createElement(g.VIDEO_OVERLAY_TAG_NAME),this.overlayDom.className=g.VIDEO_OVERLAY_CLASS_NAME,this.dom.appendChild(this.overlayDom),this.overlayDom.addEventListener("click",this.handleClick.bind(this)),this.captionDom=document.createElement(g.CAPTION_TAG_NAME),this.captionDom.setAttribute("contenteditable",!0),this.videoDom=document.createElement(g.VIDEO_TAG_NAME),this.caption&&(this.captionDom.innerText=this.caption,this.dom.appendChild(this.captionDom)),this.src&&(this.videoDom.setAttribute("src",this.src),this.videoDom.setAttribute("frameborder",0),this.videoDom.setAttribute("allowfullscreen",!0),this.width&&this.videoDom.setAttribute("width",this.width),this.height&&this.videoDom.setAttribute("height",this.height),this.dom.appendChild(this.videoDom))};g.prototype=new f,b.exports=g,g.CLASS_NAME="YouTubeComponent",g.CONTAINER_TAG_NAME="figure",g.VIDEO_OVERLAY_TAG_NAME="div",g.VIDEO_TAG_NAME="iframe",g.CAPTION_TAG_NAME="figcaption",g.VIDEO_OVERLAY_CLASS_NAME="video-overlay",g.YOUTUBE_URL_REGEXS=['(?:https?://(?:www.)?youtube.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu.be/)([^"&?/ ]{11})'],g.onInstall=function(a){g.registerRegexes_(a)},g.registerRegexes_=function(a){for(var b=0;b<g.YOUTUBE_URL_REGEXS.length;b++)a.registerRegex(g.YOUTUBE_URL_REGEXS[b],g.handleMatchedRegex)},g.createYouTubeComponentFromLink=function(a){for(var b=a,c=0;c<g.YOUTUBE_URL_REGEXS.length;c++){var d=new RegExp(g.YOUTUBE_URL_REGEXS),e=d.exec(b);if(e){b=g.createEmbedSrcFromId(e[1]);break}}return new g({src:b})},g.handleMatchedRegex=function(a,b){var c=a.getIndexInSection(),e=[],f=g.createYouTubeComponentFromLink(a.text);f.section=a.section,d.arrays.extend(e,a.getDeleteOps(c)),d.arrays.extend(e,f.getInsertOps(c)),b(e)},g.createEmbedSrcFromId=function(a){return"https://www.youtube.com/embed/"+a+"?rel=0&amp;showinfo=0&amp;iv_load_policy=3"},g.prototype.getJSONModel=function(){var a={name:this.name,src:this.src,caption:this.caption};return a},g.prototype.handleClick=function(){var a=e.getInstance();return a.setCursor({component:this,offset:0}),!1},g.prototype.getDeleteOps=function(a){return[{"do":{op:"deleteComponent",component:this.name},undo:{op:"insertComponent",componentClass:"YouTubeComponent",section:this.section.name,component:this.name,index:this.getIndexInSection()+(a||0),attrs:{src:this.src,caption:this.caption,width:this.width}}}]},g.prototype.getInsertOps=function(a){return[{"do":{op:"insertComponent",componentClass:"YouTubeComponent",section:this.section.name,cursorOffset:0,component:this.name,index:a,attrs:{src:this.src,width:this.width,caption:this.caption}},undo:{op:"deleteComponent",component:this.name}}]},g.prototype.getLength=function(){return 1}},{"../component":2,"../selection":18,"../utils":22}],13:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./selection"),f=a("./component"),g=a("./paragraph"),h=function(a){var b=d.extend({src:"",caption:null,width:"100%"},a);f.call(this,b),this.src=b.src,this.isDataUrl=!!b.src&&0!==b.src.indexOf("http"),this.width=b.width,this.caption=b.caption,this.captionParagraph=new g({placeholderText:"Type caption for image",text:b.caption,paragraphType:g.Types.Caption,parentComponent:this,inline:!0}),this.dom=document.createElement(h.CONTAINER_TAG_NAME),this.dom.setAttribute("contenteditable",!1),this.dom.setAttribute("name",this.name),this.imgDom=document.createElement(h.IMAGE_TAG_NAME),this.imgDom.addEventListener("click",this.handleClick.bind(this)),this.src&&(this.imgDom.setAttribute("src",this.src),this.width&&this.imgDom.setAttribute("width",this.width),this.dom.appendChild(this.imgDom)),this.captionDom=this.captionParagraph.dom,this.captionDom.setAttribute("contenteditable",!0),this.dom.appendChild(this.captionDom)};h.prototype=Object.create(f.prototype),b.exports=h,h.CLASS_NAME="Figure",h.CONTAINER_TAG_NAME="figure",h.IMAGE_TAG_NAME="img",h.CAPTION_TAG_NAME="figcaption",h.IMAGE_URL_REGEXS=["https?://(.*).(jpg|png|gif|jpeg)$"],h.onInstall=function(a){h.registerRegexes_(a)},h.registerRegexes_=function(a){for(var b=0;b<h.IMAGE_URL_REGEXS.length;b++)a.registerRegex(h.IMAGE_URL_REGEXS[b],h.handleMatchedRegex)},h.handleMatchedRegex=function(a,b){var c=a.text,e=a.getIndexInSection(),f=[],g=new h({src:c});g.section=a.section,d.arrays.extend(f,a.getDeleteOps(e)),d.arrays.extend(f,g.getInsertOps(e)),b(f)},h.prototype.getJSONModel=function(){var a={name:this.name,caption:this.captionParagraph.getJSONModel()};return this.isDataUrl||(a.src=this.src),a},h.prototype.handleClick=function(){var a=e.getInstance();a.setCursor({component:this,offset:0})},h.prototype.getDeleteOps=function(a){return[{"do":{op:"deleteComponent",component:this.name},undo:{op:"insertComponent",componentClass:"Figure",section:this.section.name,component:this.name,index:this.getIndexInSection()+(a||0),attrs:{src:this.src,caption:this.caption,width:this.width}}}]},h.prototype.getInsertOps=function(a){return[{"do":{op:"insertComponent",componentClass:"Figure",section:this.section.name,cursorOffset:0,component:this.name,index:a,attrs:{src:this.src,width:this.width,caption:this.caption}},undo:{op:"deleteComponent",component:this.name}}]},h.prototype.getLength=function(){return 1},h.prototype.updateAttributes=function(a){a.src&&this.updateSource(a.src),a.caption&&this.updateCaption(a.caption)},h.prototype.updateSource=function(a){this.src=a,this.isDataUrl=!!this.src&&0!==this.src.indexOf("http"),this.imgDom.setAttribute("src",a)},h.prototype.updateCaption=function(a){this.caption=a,this.captionParagraph.setText(a)}},{"./component":2,"./paragraph":16,"./selection":18,"./utils":22}],14:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./section"),f=a("./paragraph"),g=function(a){var b=d.extend({tagName:g.UNORDERED_LIST_TAG,components:[new f({paragraphType:f.Types.ListItem})]},a);e.call(this,b)};g.prototype=Object.create(e.prototype),b.exports=g,g.CLASS_NAME="List",g.UNORDERED_LIST_TAG="UL",g.ORDERED_LIST_TAG="OL",g.UNORDERED_LIST_REGEX="^(?:\\*|-)\\s?(.*)",g.ORDERED_LIST_REGEX="^(?:1\\.|-|_|\\))\\s?(.*)",g.onInstall=function(a){g.registerRegexes_(a)},g.registerRegexes_=function(a){a.registerRegex(g.UNORDERED_LIST_REGEX,g.handleULMatchedRegex),a.registerRegex(g.ORDERED_LIST_REGEX,g.handleOLMatchedRegex)},g.createListOpsForMatchedRegex_=function(a,b,c){var e=a.getIndexInSection(),h=[],i=new g({tagName:c,section:a.section,components:[new f({text:b,paragraphType:f.Types.ListItem})]});d.arrays.extend(h,a.getDeleteOps(e)),d.arrays.extend(h,i.getInsertOps(e));var j=new f({paragraphType:f.Types.ListItem,section:i});return d.arrays.extend(h,j.getInsertOps(1)),h},g.handleULMatchedRegex=function(a,b){var c=new RegExp(g.UNORDERED_LIST_REGEX),d=c.exec(a.text),e=d[1],f=g.createListOpsForMatchedRegex_(a,e,g.UNORDERED_LIST_TAG);b(f)},g.handleOLMatchedRegex=function(a,b){var c=new RegExp(g.ORDERED_LIST_REGEX),d=c.exec(a.text),e=d[1],f=g.createListOpsForMatchedRegex_(a,e,g.ORDERED_LIST_TAG);b(f)},g.prototype.getDeleteOps=function(a){return[{"do":{op:"deleteComponent",component:this.name},undo:{op:"insertComponent",componentClass:"List",section:this.section.name,component:this.name,index:this.getIndexInSection()+(a||0),attrs:{components:this.components,tagName:this.tagName}}}]},g.prototype.getInsertOps=function(a){return[{"do":{op:"insertComponent",componentClass:"List",section:this.section.name,cursorOffset:0,component:this.name,index:a,attrs:{components:this.components,tagName:this.tagName}},undo:{op:"deleteComponent",component:this.name}}]},g.prototype.getSplitOps=function(a){var b=this.getDeleteOps(),c=d.getUID();return d.arrays.extend(b,[{"do":{op:"insertComponent",componentClass:"List",section:this.section.name,cursorOffset:0,component:this.name,index:this.getIndexInSection(),attrs:{components:this.components.slice(0,a),tagName:this.tagName}},undo:{op:"deleteComponent",component:this.name}},{"do":{op:"insertComponent",componentClass:"List",section:this.section.name,cursorOffset:0,component:c,index:this.getIndexInSection()+1,attrs:{components:this.components.slice(a,this.getLength()),tagName:this.tagName}},undo:{op:"deleteComponent",component:c}}]),b},g.prototype.getLength=function(){return this.components.length}},{"./paragraph":16,"./section":17,"./utils":22}],15:[function(a,b,c){"use strict";b.exports.Editor=a("./editor"),b.exports.Article=a("./article"),b.exports.Paragraph=a("./paragraph"),b.exports.List=a("./list"),b.exports.Figure=a("./figure"),b.exports.YouTubeComponent=a("./extensions/youtubeComponent"),b.exports.Section=a("./section"),b.exports.Selection=a("./selection"),b.exports.Formatting=a("./extensions/formatting"),b.exports.GiphyComponent=a("./extensions/giphyComponent")},{"./article":1,"./editor":3,"./extensions/formatting":7,"./extensions/giphyComponent":8,"./extensions/youtubeComponent":12,"./figure":13,"./list":14,"./paragraph":16,"./section":17,"./selection":18}],16:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./component"),f=function(a){var b=d.extend({text:"",placeholderText:null,paragraphType:f.Types.Paragraph,formats:[]},a);e.call(this,b),this.text=b.text,this.placeholderText=b.placeholderText,this.formats=b.formats,this.paragraphType=b.paragraphType,this.dom=document.createElement(this.paragraphType),this.dom.setAttribute("name",this.name),this.placeholderText?this.dom.setAttribute("placeholder",this.placeholderText):this.text.length||(this.dom.innerHTML="&#8203;"),this.setText(b.text),this.formats&&this.updateInnerDom_()};f.prototype=Object.create(e.prototype),b.exports=f,f.CLASS_NAME="Paragraph",f.Types={Paragraph:"p",MainHeader:"h1",SecondaryHeader:"h2",ThirdHeader:"h3",Quote:"blockquote",Code:"pre",Caption:"figcaption",ListItem:"li"},f.onInstall=function(a){},f.prototype.setText=function(a){this.text=a||"",this.text.length||this.placeholderText?this.dom.innerText=this.text:this.dom.innerHTML="&#8203;"},f.prototype.insertCharactersAt=function(a,b){var c=[this.text.substring(0,b),this.text.substring(b)],d=c.join(a);this.shiftFormatsFrom_(b,a.length),this.setText(d),this.updateInnerDom_()},f.prototype.removeCharactersAt=function(a,b){var c=[this.text.substring(0,a),this.text.substring(a+b)],d=c.join("");this.shiftFormatsFrom_(a,-1*b),this.setText(d),this.updateInnerDom_()},f.prototype.shiftFormatsFrom_=function(a,b){for(var c=[],d=0;d<this.formats.length;d++)a<=this.formats[d].from&&a-b>=this.formats[d].to&&c.push(d),this.formats[d].from>=a&&(this.formats[d].from+=b),this.formats[d].to>a&&(this.formats[d].to+=b);for(d=0;d<c.length;d++)this.formats.splice(c[d],1)},f.prototype.updateInnerDom_=function(){if(!this.formats.length)return void this.setText(this.text);for(var a,b=document.createElement(this.paragraphType),c=0,d=0,e=0;e<this.formats.length;e++){c=this.formats[e].from,c-d>0&&(a=this.text.substring(d,c),b.appendChild(document.createTextNode(a))),d=this.formats[e].to;var f=document.createElement(this.formats[e].type);for(var g in this.formats[e].attrs)f.setAttribute(g,this.formats[e].attrs[g]);f.innerText=this.text.substring(c,d),b.appendChild(f)}var h=this.text.length;h-d>0&&(a=this.text.substring(h,d),b.appendChild(document.createTextNode(a))),this.dom.innerHTML=b.innerHTML},f.prototype.isPlaceholder=function(){return!!this.placeholderText&&!this.text.length},f.prototype.applyFormats=function(a){for(var b=0;b<a.length;b++)this.format(a[b])},f.prototype.getSelectedFormatter=function(a){for(var b=0;b<this.formats.length;b++)if(a.start.offset>=this.formats[b].from&&a.start.offset<this.formats[b].to&&a.end.offset>this.formats[b].from&&a.end.offset<=this.formats[b].to)return this.formats[b];return null},f.prototype.format=function(a,b){a=d.clone(a);var c=this.getFormattedRanges(a,!b);if(c&&c.length)for(var e=d.clone(c),f=0;f<e.length;f++){var g=e[f],h=this.formats.indexOf(c[f]);a.attrs?(g.attrs=a.attrs,this.formats[h]=g):a.to===g.to&&a.from===g.from?this.formats.splice(h,1):a.to===g.to||a.to>g.to&&a.from<g.to&&b?(g.to=a.from,this.formats[h]=g):a.from===g.from||a.from<g.from&&a.to>g.from&&b?(g.from=a.to,this.formats[h]=g):a.to<g.to&&a.from>g.from?(this.formats.splice(h,1),this.addNewFormatting({type:g.type,from:g.from,to:a.from}),this.addNewFormatting({type:g.type,from:a.to,to:g.to})):b?this.formats.splice(h,1):(g.from=Math.min(g.from,a.from),g.to=Math.max(g.to,a.to),this.formats[h]=g)}else{var i=this.getFormattedRanges(a,!1);i&&i.length?b||(this.format(a,!0),this.format(a)):this.addNewFormatting(a)}b||this.normalizeFormats_(),this.updateInnerDom_()},f.prototype.normalizeFormats_=function(){if(this.formats&&this.formats.length){for(var a=[d.clone(this.formats[0])],b=1;b<this.formats.length;b++)a[a.length-1].to>this.formats[b].from||a[a.length-1].to===this.formats[b].from&&a[a.length-1].type===this.formats[b].type?a[a.length-1].to=this.formats[b].to:a.push(d.clone(this.formats[b]));this.formats=a}},f.prototype.getFormatsForRange=function(a,b){var c=[],e=this.getFormattedRanges({from:a,to:b,type:null},!1);e=d.clone(e);for(var f=0;f<e.length;f++)e[f].from<a&&e[f].to>=a&&(e[f].from=a),e[f].to>b&&e[f].from<=b&&(e[f].to=b),e[f].from<e[f].to&&c.push(e[f]);return c},f.prototype.getFormattedRanges=function(a,b){for(var c=[],d=[],e=0;e<this.formats.length;e++)this.formats[e].from>a.to||(this.formats[e].from<a.from&&this.formats[e].to>=a.to||this.formats[e].from>=a.from&&this.formats[e].to<=a.to||this.formats[e].to>a.from&&this.formats[e].to<=a.to&&this.formats[e].from<a.from||this.formats[e].from>=a.from&&this.formats[e].from<a.to&&this.formats[e].to>a.to)&&(c.push(this.formats[e]),this.formats[e].type===a.type&&d.push(this.formats[e]));return b?d.length===c.length?d:void 0:c},f.prototype.addNewFormatting=function(a){this.formats.push(a),this.formats.sort(function(a,b){var c=a.from-b.from;return c||(c=a.type>b.type?1:a.type<b.type?-1:0),c})},f.prototype.getJSONModel=function(){var a={name:this.name,text:this.text,paragraphType:this.paragraphType};return this.formats&&(a.formats=this.formats),a},f.prototype.getDeleteOps=function(a){return[{"do":{op:"deleteComponent",component:this.name},undo:{op:"insertComponent",componentClass:"Paragraph",section:this.section.name,component:this.name,index:this.getIndexInSection()+(a||0),attrs:{text:this.text,placeholderText:this.placeholderText,paragraphType:this.paragraphType,formats:this.formats}}}]},f.prototype.getInsertOps=function(a){return[{"do":{op:"insertComponent",componentClass:"Paragraph",section:this.section.name,cursorOffset:0,component:this.name,index:a,attrs:{text:this.text,formats:this.formats,paragraphType:this.paragraphType}},undo:{op:"deleteComponent",component:this.name}}]},f.prototype.getInsertCharsOps=function(a,b){return[{"do":{op:"insertChars",component:this.name,cursorOffset:b+a.length,value:a,index:b},undo:{op:"removeChars",component:this.name,cursorOffset:b,index:b,count:a.length}}]},f.prototype.getRemoveCharsOps=function(a,b,c){return[{"do":{op:"removeChars",component:this.name,cursorOffset:b,index:b,count:a.length},undo:{op:"insertChars",component:this.name,cursorOffset:b-(c||0),value:a,index:b}}]},f.prototype.getUpdateOps=function(a,b,c){return[{"do":{op:"updateComponent",component:this.name,cursorOffset:b,selectRange:c,formats:a.formats},undo:{op:"updateComponent",component:this.name,cursorOffset:b,selectRange:c,formats:a.formats}}]},f.prototype.getLength=function(){return this.text.length}},{"./component":2,"./utils":22}],17:[function(a,b,c){"use strict";var d=a("./selection"),e=a("./utils"),f=a("./component"),g=function(a){var b=e.extend({tagName:g.TAG_NAME,components:[],background:{}},a);f.call(this,b),this.tagName=b.tagName,this.background=b.background,this.dom=document.createElement(this.tagName),this.dom.setAttribute("name",this.name),this.components=[];for(var c=0;c<b.components.length;c++)this.insertComponentAt(b.components[c],c)};g.prototype=Object.create(f.prototype),b.exports=g,g.TAG_NAME="section",g.prototype.insertComponentAt=function(a,b){a.section=this;var c=this.components[b];return c?this.dom.insertBefore(a.dom,c.dom):this.dom.appendChild(a.dom),this.components.splice(b,0,a),d.getInstance().setCursor({component:a,offset:0}),a},g.prototype.removeComponent=function(a){var b=this.components.indexOf(a),c=this.components.splice(b,1)[0];try{this.dom.removeChild(c.dom)}catch(d){if("NotFoundError"!==d.name)throw d;console.warn("The browser might have already handle removing the DOM  element (e.g. When handling cut).")}return c},g.prototype.getFirstComponent=function(){return this.components[0]},g.prototype.getLastComponent=function(){return this.components[this.components.length-1]},g.prototype.getComponentsBetween=function(a,b){for(var c=[],d=this.components.indexOf(a)+1,e=this.components.indexOf(b),f=d;e>f;f++)c.push(this.components[f]);return c},g.prototype.getJSONModel=function(){for(var a={components:[]},b=0;b<this.components.length;b++)a.components.push(this.components[b].getJSONModel());return a}},{"./component":2,"./selection":18,"./utils":22}],18:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./paragraph"),f=function(){var a="editor-selected",b=function(){this.start={component:null,offset:null},this.end={component:null,offset:null}};b.prototype=new d.CustomEventTarget,b.Events={SELECTION_CHANGED:"selectionchanged"},b.prototype.reset=function(){this.start={component:null,offset:null},this.end={component:null,offset:null}},b.prototype.getComponentAtStart=function(){return this.start?this.start.component:void 0},b.prototype.getComponentAtEnd=function(){return this.end?this.end.component:void 0},b.prototype.getSelectedComponents=function(){var a=this.start.component,b=this.end.component,c=this.getSectionAtStart().getComponentsBetween(a,b),e=[a];return d.arrays.extend(e,c),a!==b&&e.push(b),e},b.prototype.getSectionAtStart=function(){return this.getComponentAtStart()?this.getComponentAtStart().section:void 0},b.prototype.getSectionAtEnd=function(){return this.getComponentAtEnd()?this.getComponentAtEnd().section:void 0},b.prototype.select=function(a,b){this.start={component:a.component,offset:a.offset},this.end={component:b.component,offset:b.offset},this.updateWindowSelectionFromModel()},b.prototype.setCursor=function(b){this.start.component&&this.start.component.dom.classList.remove(a),this.start={component:b.component,offset:b.offset},this.end={component:b.component,offset:b.offset},this.start.component&&this.start.component.dom.classList.add(a),this.updateWindowSelectionFromModel()},b.prototype.calculateOffsetFromNode=function(a,b,c){for(var d=0,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(f===c)break;d+=(f.textContent||f.innerText).length}return d},b.prototype.updateWindowSelectionFromModel=function(){var a=document.createRange(),c=this.start.component.dom,d=this.start.offset,e=this.end.component.dom,f=this.end.offset;if(this.start.offset>0){c=this.getTextNodeAtOffset_(this.start.component.dom,d),c||(c=this.getTextNodeAtOffset_(this.start.component.dom,d-1));var g=this.calculatePreviousSiblingsOffset_(this.start.component.dom,c);d=this.start.offset-g}try{a.setStart(c,d)}catch(h){a.setStart(c,d-1)}if(e=this.end.component.dom,this.end.offset>0){e=this.getTextNodeAtOffset_(this.end.component.dom,f),e||(e=this.getTextNodeAtOffset_(this.end.component.dom,f-1));var i=this.calculatePreviousSiblingsOffset_(this.end.component.dom,e);f=this.end.offset-i}try{a.setEnd(e,f)}catch(h){a.setEnd(e,f-1)}var j=window.getSelection();j.removeAllRanges(),j.addRange(a),this.start.component.dom.scrollIntoViewIfNeeded(!1);var k=new Event(b.Events.SELECTION_CHANGED);this.dispatchEvent(k)},b.prototype.getTextNodeAtOffset_=function(a,b){for(var c=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],f=(e.textContent||e.innerText).length;if(c+f>=b)return"#text"!==e.nodeName&&(e=this.getTextNodeAtOffset_(e,b-c)),e;c+=f}return null},b.prototype.calculateStartOffsetFromWindowSelection_=function(a){var b=a.anchorNode,c=a.anchorOffset,d=b.parentNode;if(b.getAttribute&&b.getAttribute("name")||"#text"===b.nodeName&&d.getAttribute("name")&&d.childNodes.length<2)return c;var e=this.getStartComponentFromWindowSelection_(a);return c+=this.calculatePreviousSiblingsOffset_(e,b)},b.prototype.calculateEndOffsetFromWindowSelection_=function(a){var b=a.focusNode,c=a.focusOffset,d=b.parentNode;if(b.getAttribute&&b.getAttribute("name")||"#text"===b.nodeName&&d.getAttribute("name")&&d.childNodes.length<2)return c;var e=this.getEndComponentFromWindowSelection_(a);return c+=this.calculatePreviousSiblingsOffset_(e,b)},b.prototype.calculatePreviousSiblingsOffset_=function(a,b){for(var c=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(e===b)break;if("#text"!==e.nodeName){var f=(e.textContent||e.innerText).length,g=this.calculatePreviousSiblingsOffset_(e,b);if(f>g){c+=g;break}}c+=(e.textContent||e.innerText).length}return c},b.prototype.getStartComponentFromWindowSelection_=function(a){for(var b=a.anchorNode;!b.getAttribute||!b.getAttribute("name")&&b.parentNode;)b=b.parentNode;return b},b.prototype.getEndComponentFromWindowSelection_=function(a){for(var b=a.focusNode;!b.getAttribute||!b.getAttribute("name")&&b.parentNode;)b=b.parentNode;return b},b.prototype.updateSelectionFromWindow=function(){var c=window.getSelection();this.start.component&&this.start.component.dom.classList.remove(a);var e=this.getStartComponentFromWindowSelection_(c),f={component:d.getReference(e.getAttribute("name")),offset:this.calculateStartOffsetFromWindowSelection_(c)},g=this.getEndComponentFromWindowSelection_(c),h={component:d.getReference(g.getAttribute("name")),offset:this.calculateEndOffsetFromWindowSelection_(c)},i=h.component.getIndexInSection(),j=f.component.getIndexInSection(),k=h.component===f.component&&h.offset<f.offset||j>i;this.end=k?f:h,this.start=k?h:f,this.start.component===this.end.component&&this.start.component.dom.classList.add(a);var l=new Event(b.Events.SELECTION_CHANGED);this.dispatchEvent(l)},b.prototype.isCursorAtBeginning=function(){return 0===this.start.offset&&0===this.end.offset},b.prototype.isCursorAtEnding=function(){return!(this.start.component instanceof e)||this.start.offset===this.start.component.getLength()&&this.end.offset===this.end.component.getLength()},b.prototype.isRange=function(){return this.start.component!=this.end.component||this.start.offset!=this.end.offset},b.prototype.initSelectionListener=function(a){a.addEventListener("mouseup",this.updateSelectionFromWindow.bind(this)),a.addEventListener("keyup",this.updateSelectionFromWindow.bind(this))};var c;return{getInstance:function(){return c||(c=new b,c.constructor=null),c},Events:b.Events}}();b.exports=f},{"./paragraph":16,"./utils":22}],19:[function(a,b,c){"use strict";var d=a("../utils"),e=function(a){var b=d.extend({label:"New Button",name:d.getUID(),fields:[],data:{}},a);d.CustomEventTarget.call(this),this.name=b.name,this.data=b.data,this.fields=[],this.dom=document.createElement(e.CONTAINER_TAG_NAME),this.dom.className=e.CONTAINER_CLASS_NAME,this.buttonDom=document.createElement(e.TAG_NAME),this.buttonDom.setAttribute("name",this.name),this.buttonDom.innerText=b.label,this.buttonDom.addEventListener("click",this.handleClick.bind(this)),this.dom.appendChild(this.buttonDom),this.fieldsDom=document.createElement(e.FIELDS_CONTAINER_TAG_NAME),this.fieldsDom.className=e.FIELDS_CONTAINER_CLASS_NAME;for(var c=0;c<b.fields.length;c++)this.addField(b.fields[c])};e.prototype=Object.create(d.CustomEventTarget.prototype),b.exports=e,e.CONTAINER_TAG_NAME="div",e.CONTAINER_CLASS_NAME="button-container",e.TAG_NAME="button",e.FIELDS_CONTAINER_TAG_NAME="div",e.FIELDS_CONTAINER_CLASS_NAME="extra-fields",e.ACTIVE_CLASS_NAME="active",e.HIDDEN_CLASS_NAME="hidden",e.prototype.handleClick=function(){var a=new CustomEvent("click",{detail:{target:this}});this.dispatchEvent(a)},e.prototype.addField=function(a){a.parentButton=this,this.fields.push(a),this.fieldsDom.appendChild(a.dom)},e.prototype.setActive=function(a){this.isActive=a,this.isActive?(this.dom.classList.add(e.ACTIVE_CLASS_NAME),this.fieldsDom.classList.add(e.ACTIVE_CLASS_NAME),this.hasExtraFields()&&this.fields[0].dom.focus()):(this.dom.classList.remove(e.ACTIVE_CLASS_NAME),this.fieldsDom.classList.remove(e.ACTIVE_CLASS_NAME))},e.prototype.setVisible=function(a){this.isVisible=a,this.isVisible?this.dom.classList.remove(e.HIDDEN_CLASS_NAME):this.dom.classList.add(e.HIDDEN_CLASS_NAME)},e.prototype.hasExtraFields=function(){return this.fields&&this.fields.length},e.prototype.getFieldByName=function(a){for(var b=0;b<this.fields.length;b++)if(this.fields[b].name===a)return this.fields[b];return null},e.prototype.resetFields=function(){for(var a=0;a<this.fields.length;a++)this.fields[a].setValue("")}},{"../utils":22}],20:[function(a,b,c){"use strict";var d=a("../utils"),e=function(a){var b=d.extend({placeholder:"New field",name:d.getUID(),required:!0,data:{},value:""},a);d.CustomEventTarget.call(this),this.name=b.name,this.data=b.data,this.placeholder=b.placeholder,this.required=b.required,this.parentButton=null,this.value=b.value,this.dom=document.createElement(e.TAG_NAME),this.dom.setAttribute("placeholder",this.placeholder),this.dom.setAttribute("name",this.name),this.dom.setAttribute("required",this.required),this.dom.addEventListener("keyup",this.handleKeyUp.bind(this))};e.prototype=Object.create(d.CustomEventTarget.prototype),b.exports=e,e.TAG_NAME="input",e.prototype.handleKeyUp=function(a){this.value=this.dom.value;var b=new CustomEvent("keyup",{detail:{target:this}});b.keyCode=a.keyCode,this.dispatchEvent(b)},e.prototype.setValue=function(a){this.value=a,this.dom.value=a}},{"../utils":22}],21:[function(a,b,c){"use strict";var d=a("../utils"),e=function(a){d.CustomEventTarget.call(this);var b=d.extend({buttons:[],classNames:[],name:d.getUID()},a);this.name=b.name,this.classNames=b.classNames,this.classNames.push(e.TOOLBAR_CLASS_NAME),this.rtl=!1,this.buttons=[],this.activeButton=null,this.isVisible=!1,this.dom=document.createElement(e.TAG_NAME),this.dom.id=e.DOM_ID_PREFIX+this.name,this.dom.className=this.classNames.join(" "),this.containerDom=document.createElement(e.BUTTONS_CONTAINER_TAG_NAME),this.containerDom.className=e.BUTTONS_FIELDS_CONTAINER_CLASS_NAME,this.dom.appendChild(this.containerDom),this.buttonsContainer=document.createElement(e.BUTTONS_CONTAINER_TAG_NAME),this.buttonsContainer.className=e.BUTTONS_CONTAINER_CLASS_NAME,this.containerDom.appendChild(this.buttonsContainer),this.fieldsContainer=document.createElement(e.FIELDS_CONTAINER_TAG_NAME),this.fieldsContainer.className=e.FIELDS_CONTAINER_CLASS_NAME,this.containerDom.appendChild(this.fieldsContainer);for(var c=0;c<b.buttons.length;c++)this.addButton(b.buttons[c]);document.body.appendChild(this.dom)};e.prototype=Object.create(d.CustomEventTarget.prototype),b.exports=e,e.TAG_NAME="div",e.FIELDS_CONTAINER_TAG_NAME="div",e.BUTTONS_CONTAINER_TAG_NAME="div",e.DOM_ID_PREFIX="editor-inline-toolbar-",e.TOOLBAR_CLASS_NAME="editor-toolbar",e.VISIBLE_CLASS_NAME="toolbar-visible",e.BUTTONS_CONTAINER_CLASS_NAME="editor-toolbar-buttons",e.FIELDS_CONTAINER_CLASS_NAME="extra-fields-container",e.BUTTONS_FIELDS_CONTAINER_CLASS_NAME="buttons-fields-container",e.EDGE=-999999,e.prototype.addButton=function(a){var b=new CustomEvent("button-added",{detail:{target:this}});this.buttons.push(a),this.buttonsContainer.appendChild(a.dom),this.fieldsContainer.appendChild(a.fieldsDom),this.dispatchEvent(b)},e.prototype.setVisible=function(a){this.isVisible=a,this.isVisible?this.dom.classList.add(e.VISIBLE_CLASS_NAME):(this.dom.classList.remove(e.VISIBLE_CLASS_NAME),this.dom.style.top=e.EDGE+"px",this.dom.style.left=e.EDGE+"px")},e.prototype.setPositionToStartTopOf=function(a){var b=a.getBoundingClientRect(),c=b.top+window.pageYOffset,d=b.left;if(this.rtl){var e=this.dom.getBoundingClientRect();d=b.right-e.width}this.dom.style.top=c+"px",this.dom.style.left=d+"px"},e.prototype.setPositionToStartBottomOf=function(a){var b=a.getBoundingClientRect(),c=b.bottom+window.pageYOffset,d=b.left;if(this.rtl){var e=this.dom.getBoundingClientRect();d=b.right-e.width}this.dom.style.top=c+"px",this.dom.style.left=d+"px"},e.prototype.setPositionTopOfSelection=function(){var a=window.getSelection(),b=a.getRangeAt(0),c=b.getBoundingClientRect(),d=document.body.getBoundingClientRect(),e=this.dom.getClientRects()[0],f=e.height,g=e.width,h=(c.left+c.right)/2-g/2;h=Math.max(10,h),h=Math.min(h,d.width-g-10);var i=c.top+window.pageYOffset-f-10;this.dom.style.top=i+"px",this.dom.style.left=h+"px"},e.prototype.getButtonByName=function(a){for(var b=0;b<this.buttons.length;b++)if(this.buttons[b].name===a)return this.buttons[b];return null},e.prototype.setActiveButton=function(a){this.activeButton&&(this.activeButton.setActive(!1),this.activeButton=null),a&&(a.setActive(!0),this.activeButton=a)},e.prototype.resetFields=function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].resetFields()}},{"../utils":22}],22:[function(a,b,c){"use strict";var d={};d.arrays={},b.exports=d,d.GLOBAL_REFERENCE={},d.extend=function(a,b){var c,d={};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];return d},d.arrays.extend=function(a,b){for(var c in b)a.push(b[c]);return a},d.setReference=function(a,b){d.GLOBAL_REFERENCE[a]=b},d.getReference=function(a){return d.GLOBAL_REFERENCE[a]},d.getUID=function(a){for(var b=a||4,c=[],d="abcdefghijklmnopqrstuvwxyz0123456789",e=0;b>e;e++)c.push(d.charAt(Math.floor(Math.random()*d.length)));return c.join("")},d.willTypeCharacter=function(a){var b=[16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145];return-1===b.indexOf(a.keyCode)&&!a.ctrlKey&&!a.metaKey},d.isUndo=function(a){return!(!a.ctrlKey&&!a.metaKey||90!==a.keyCode||a.shiftKey)},d.isRedo=function(a){return!(!a.ctrlKey&&!a.metaKey||!(89===a.keyCode||a.shiftKey&&90===a.keyCode))},d.isSelectAll=function(a){return!(!a.ctrlKey&&!a.metaKey||65!==a.keyCode||a.shiftKey)},d.clone=function(a){var b;if(null===a||"object"!=typeof a)return a;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){b=[];for(var c=0,e=a.length;e>c;c++)b[c]=d.clone(a[c]);return b}if(a instanceof Object){b={};for(var f in a)a.hasOwnProperty(f)&&(b[f]=d.clone(a[f]));return b}throw new Error("Unable to copy object! Its type is not supported.")},d.CustomEventTarget=function(){this._init();

},d.CustomEventTarget.prototype._init=function(){this._registrations={}},d.CustomEventTarget.prototype._getListeners=function(a,b){var c=(b?"1":"0")+a;return c in this._registrations||(this._registrations[c]=[]),this._registrations[c]},d.CustomEventTarget.prototype.addEventListener=function(a,b,c){var d=this._getListeners(a,c),e=d.indexOf(b);-1===e&&d.push(b)},d.CustomEventTarget.prototype.removeEventListener=function(a,b,c){var d=this._getListeners(a,c),e=d.indexOf(b);-1!==e&&d.splice(e,1)},d.CustomEventTarget.prototype.dispatchEvent=function(a){for(var b=this._getListeners(a.type,!1).slice(),c=0;c<b.length;c++)b[c].call(this,a);return!a.defaultPrevented}},{}]},{},[15])(15)});